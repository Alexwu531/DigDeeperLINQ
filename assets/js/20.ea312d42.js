(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{220:function(t,e,r){"use strict";r.r(e);var s=r(0),a=Object(s.a)({},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"content"},[t._m(0),t._v(" "),r("p",[t._v("應該有很多人覺得很奇怪，這系列的主題明明是LINQ，可是為什麼前面幾篇卻都不是在講LINQ呢?在這章我們就來介紹LINQ的用途，及LINQ跟前面講到的技術到底有什麼樣的關係吧。")]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),r("p",[t._v("上面有提到，LINQ是一種能力，微軟開發出了很多不同的技術讓C#擁有這樣的能力，接下來就稍微簡介一下這些技術分別是哪些吧。")]),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),r("p",[t._v("為了使LINQ可以更加便捷的使用而將C#擴充了以下的功能:")]),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._m(12),t._v(" "),t._m(13),t._m(14),t._v(" "),t._m(15),r("p",[t._v("C#因為有查詢運算式，所以可以在程式中直接撰寫查詢語法，使得我們可以輕鬆的表達出我們想要的資料處理，再經由轉換最後變為SQL的查詢語法。")]),t._v(" "),t._m(16),t._v(" "),r("p",[t._v("隱含型別變數就是我們在JavaScript上又愛又恨的"),r("code",[t._v("var")]),t._v("，但C#中的"),r("code",[t._v("var")]),t._v("變數還是強型別的變數，它會透過賦予變數的型別來推斷此變數為何種型別("),r("a",{attrs:{href:"https://en.wikipedia.org/wiki/Type_inference",target:"_blank",rel:"noopener noreferrer"}},[t._v("type inference"),r("OutboundLink")],1),t._v(")。")]),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),r("p",[t._v("可以直接在"),r("code",[t._v("new")]),t._v("的時候訂定類別的參數初始值，例如說像是下面這樣("),r("a",{attrs:{href:"https://en.wikipedia.org/wiki/C_Sharp_syntax#Object_initializers",target:"_blank",rel:"noopener noreferrer"}},[t._v("參考自維基百科"),r("OutboundLink")],1),t._v("):")]),t._v(" "),t._m(20),t._m(21),t._v(" "),r("p",[t._v("Lambda運算式在前面的章節講過，是一種匿名方法，LINQ在Query Expression轉為Standard Query Operators時會使用它來做轉換，另外我們以方法使用LINQ時也會使用Lambda。")]),t._v(" "),t._m(22),t._v(" "),r("p",[t._v("上面介紹了這麼多的Language Extensions，看到這邊應該還是有點模糊吧，我們用個例子來說明("),r("a",{attrs:{href:"https://en.wikipedia.org/wiki/Language_Integrated_Query#Language_extensions",target:"_blank",rel:"noopener noreferrer"}},[t._v("節錄自維基百科"),r("OutboundLink")],1),t._v("):")]),t._v(" "),t._m(23),t._m(24),t._v(" "),r("p",[t._v("在這裡我們看到了不少剛剛介紹過的特性，我會在下面逐條列出:")]),t._v(" "),t._m(25),r("p",[t._v("而這個例子在經過Compiler之後會變成下面這樣的Standard Query Operators:")]),t._v(" "),t._m(26),r("p",[t._v("由這範例就可以知道上述的語言擴充都是LINQ所必需要有的。")]),t._v(" "),t._m(27),t._v(" "),t._m(28),t._v(" "),t._m(29),t._v(" "),t._m(30),t._v(" "),t._m(31),t._v(" "),t._m(32),t._v(" "),t._m(33),t._v(" "),r("p",[t._v("這章帶著大家跟我一起了解LINQ背後的技術及其特性，希望之後在介紹標準查詢運算子時會有更具體的了解。")]),t._v(" "),t._m(34),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://docs.microsoft.com/zh-tw/dotnet/csharp/linq/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Microsoft Docs-C#指南-LINQ"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://docs.microsoft.com/zh-tw/dotnet/csharp/programming-guide/concepts/linq/index",target:"_blank",rel:"noopener noreferrer"}},[t._v("Microsoft Docs-LINQ"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://en.wikipedia.org/wiki/Language_Integrated_Query",target:"_blank",rel:"noopener noreferrer"}},[t._v("wiki-Language_Integrated_Query"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://en.wikipedia.org/wiki/Anonymous_type",target:"_blank",rel:"noopener noreferrer"}},[t._v("wiki-Anonymous_type"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://en.wikipedia.org/wiki/C_Sharp_syntax",target:"_blank",rel:"noopener noreferrer"}},[t._v("wiki-C_Sharp_syntax"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://docs.microsoft.com/zh-tw/dotnet/csharp/language-reference/language-specification/expressions#query-expressions",target:"_blank",rel:"noopener noreferrer"}},[t._v("Microsoft Docs-C# Spec-expressions#query-expressions"),r("OutboundLink")],1)])])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"所以什麼是linq"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#所以什麼是linq","aria-hidden":"true"}},[this._v("#")]),this._v(" 所以什麼是LINQ?")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"linq的介紹"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#linq的介紹","aria-hidden":"true"}},[this._v("#")]),this._v(" LINQ的介紹")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("LINQ全名為"),e("strong",[this._v("Language Integrated Query")]),this._v("，顧名思義就是此"),e("strong",[this._v("程式語言擁有查詢資料的能力")]),this._v("，LINQ的出現使得C#\n(F#、VB.NET也可以使用)有能力可以在程式中查找資料。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("在沒有LINQ技術之前我們在查詢資料時會需要學習另一種查詢語法來達到查詢的需求，例如像是XML、SQL...等，除了要花費學習的精力外，也因為C#並不認識這些語法，所以寫出來的查詢語法在C#中並"),e("strong",[this._v("不會有型別檢查或是自動完成")]),this._v("的功能，對於工程師來說這無疑會是一個除錯地獄。")])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("p",[t._v("有了LINQ之後，利用"),r("strong",[t._v("標準查詢運算子")]),t._v("(Standard Query Operators)，工程師可以用原生的C#語言對資料做處理，"),r("strong",[t._v("選擇資料來源")]),t._v("、"),r("strong",[t._v("進行篩選")]),t._v("到"),r("strong",[t._v("組合")]),t._v("、"),r("strong",[t._v("分組")]),t._v("都可以利用標準查詢運算子完成，而且在撰寫的過程中還可以享受到"),r("strong",[t._v("型別檢查及自動完成帶來的便捷")]),t._v("。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"linq的組成"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#linq的組成","aria-hidden":"true"}},[this._v("#")]),this._v(" LINQ的組成")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"standard-query-operators"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#standard-query-operators","aria-hidden":"true"}},[this._v("#")]),this._v(" Standard Query Operators")])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("p",[t._v("標準查詢運算子是應用於集合類別的運算子，它對集合實作了"),r("strong",[t._v("篩選")]),t._v("、"),r("strong",[t._v("組合")]),t._v("、"),r("strong",[t._v("排序")]),t._v("..等等的運算功能，像是Select、Where、OrderBy...等方法，而這些方法就是運作於"),r("code",[t._v("IEnumerable<T>")]),t._v("、"),r("code",[t._v("IQueryable<T>")]),t._v("之上，所以前面的章節說明"),r("strong",[t._v("IEnumerable")]),t._v("及"),r("strong",[t._v("泛型")]),t._v("就是想要講解LINQ的核心運作方式。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"language-extensions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#language-extensions","aria-hidden":"true"}},[this._v("#")]),this._v(" Language Extensions")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"query-expression-query-syntax"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#query-expression-query-syntax","aria-hidden":"true"}},[this._v("#")]),this._v(" Query Expression(Query Syntax)")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("查詢運算式(Query Expression)是一種跟SQL搜尋語法相似的運算式，透過查詢運算式，我們可以對資料做相關的處理，下面是一個最基本的"),e("strong",[this._v("查詢運算式")]),this._v(":")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-C# extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("from x in Products\nselect x.ProductName\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("此段語法會被Compiler轉譯為"),e("strong",[this._v("標準查詢運算子")]),this._v(":")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-C# extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("Products\n   .Select (x => x.ProductName)\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("而最後進資料庫的會是下面這樣的"),e("strong",[this._v("SQL語法")]),this._v(":")])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"language-SQL extra-class"},[r("pre",{pre:!0,attrs:{class:"language-sql"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("t0"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("ProductName"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Products"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("t0"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"implicitly-typed-variables"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#implicitly-typed-variables","aria-hidden":"true"}},[this._v("#")]),this._v(" Implicitly typed variables")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"anonymous-types"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#anonymous-types","aria-hidden":"true"}},[this._v("#")]),this._v(" Anonymous types")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("匿名型別可以"),e("strong",[this._v("只宣告資料欄位而不需要明確定義類別")]),this._v("，這樣的技術在Select或是Join的時候非常好用，因為這些查詢有很大的機會不會是原來的物件。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"object-initializer"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#object-initializer","aria-hidden":"true"}},[this._v("#")]),this._v(" Object Initializer")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-C# extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('Person person = new Person {\n    Name = "John Doe",\n    Age = 39\n};  // Object Initializer\n\n// Equal to\nPerson person = new Person();\nperson.Name = "John Doe";\nperson.Age = 39;\n')])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"lambda-expression"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#lambda-expression","aria-hidden":"true"}},[this._v("#")]),this._v(" Lambda expression")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"範例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#範例","aria-hidden":"true"}},[this._v("#")]),this._v(" 範例")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-C# extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("var results =  from c in SomeCollection\n               where c.SomeProperty < 10\n               select new {c.SomeProperty, c.OtherProperty};\n\nforeach (var result in results)\n{\n        Console.WriteLine(result);\n}\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("這範例是"),e("strong",[this._v("從Somecollection找出SomeProperty小於10的資料並將SomeProperty及OtherProperty取出，並且輸出在終端上")]),this._v("。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-C# extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("var results //Implicitly typed variables\n    = from c in SomeCollection  //Query Expression\n      where c.SomeProperty < 10\n      select new {c.SomeProperty, c.OtherProperty}; //Anonymous types和Object Initializer\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-C# extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("var results =\n     SomeCollection\n        .Where(c => c.SomeProperty < 10)    //Lambda Expression\n        .Select(c => new {c.SomeProperty, c.OtherProperty});\n\nresults.ForEach(x => {Console.WriteLine(x.ToString());})    //Lambda Statement\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"linq-providers"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#linq-providers","aria-hidden":"true"}},[this._v("#")]),this._v(" LINQ providers")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("有沒有想過為什麼LINQ可以對Objects、Database做查詢?這中間其實就是有Provider在幫我們做事情，透過Provider，我們可以在不需要了解實際運作下對其做資料的處理，我們這裡舉兩個例子: "),e("strong",[this._v("LINQ to Objects")]),this._v("及"),e("strong",[this._v("LINQ to SQL")]),this._v("。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"linq-to-objects"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#linq-to-objects","aria-hidden":"true"}},[this._v("#")]),this._v(" LINQ to Objects")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("我們在之前介紹過的"),e("code",[this._v("IEnumerable")]),this._v("，Provider就是利用這個介面去對任何要查詢的物件做處理，只要你的物件有實作"),e("code",[this._v("IEnumerable")]),this._v("這個物件，你就可以使用LINQ。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"linq-to-sql"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#linq-to-sql","aria-hidden":"true"}},[this._v("#")]),this._v(" LINQ to SQL")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("因為Database有自己的查詢引擎，所以無法直接透過LINQ的語法做處理，Provider處理了"),e("strong",[this._v("LINQ與SQL查詢語法間的轉換")]),this._v("還有"),e("strong",[this._v("應用程式與資料庫間的溝通")]),this._v("。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"結語"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#結語","aria-hidden":"true"}},[this._v("#")]),this._v(" 結語")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"參考"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#參考","aria-hidden":"true"}},[this._v("#")]),this._v(" 參考")])}],!1,null,null,null);e.default=a.exports}}]);