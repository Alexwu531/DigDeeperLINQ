(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{233:function(e,t,r){"use strict";r.r(t);var n=r(0),s=Object(n.a)({},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"content"},[e._m(0),e._v(" "),e._m(1),e._v(" "),e._m(2),e._v(" "),r("blockquote",[r("p",[e._v("Source Code: "),r("a",{attrs:{href:"https://github.com/dotnet/corefx/blob/master/src/System.Linq/src/System/Linq/Take.cs",target:"_blank",rel:"noopener noreferrer"}},[e._v("Take.cs"),r("OutboundLink")],1)])]),e._v(" "),e._m(3),e._v(" "),e._m(4),e._v(" "),r("p",[e._v("方法的實作如下:")]),e._v(" "),e._m(5),e._m(6),e._v(" "),e._m(7),e._v(" "),e._m(8),e._v(" "),e._m(9),e._v(" "),e._m(10),e._v(" "),e._m(11),e._v(" "),r("p",[e._v("TakeLast的方法有做下面幾件事:")]),e._v(" "),e._m(12),e._v(" "),e._m(13),e._v(" "),e._m(14),r("p",[e._v("這段程式我們可以知道:")]),e._v(" "),e._m(15),e._v(" "),e._m(16),e._v(" "),e._m(17),e._v(" "),e._m(18),e._v(" "),e._m(19),e._v(" "),e._m(20),e._v(" "),e._m(21),e._m(22),e._v(" "),e._m(23),e._v(" "),r("blockquote",[r("p",[e._v("Source Code: "),r("a",{attrs:{href:"https://github.com/dotnet/corefx/blob/master/src/System.Linq/tests/TakeTests.cs",target:"_blank",rel:"noopener noreferrer"}},[e._v("TakeTests.cs"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://github.com/dotnet/corefx/blob/master/src/System.Linq/tests/TakeLastTests.cs",target:"_blank",rel:"noopener noreferrer"}},[e._v("TakeLastTests.cs"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://github.com/dotnet/corefx/blob/master/src/System.Linq/tests/TakeWhileTests.cs",target:"_blank",rel:"noopener noreferrer"}},[e._v("TakeWhileTests.cs"),r("OutboundLink")],1)])]),e._v(" "),e._m(24),e._v(" "),e._m(25),e._v(" "),e._m(26),e._m(27),e._v(" "),e._m(28),e._v(" "),e._m(29),e._v(" "),e._m(30),e._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://github.com/dotnet/corefx",target:"_blank",rel:"noopener noreferrer"}},[e._v("dotnet/corefx"),r("OutboundLink")],1)])])])},[function(){var e=this.$createElement,t=this._self._c||e;return t("h1",{attrs:{id:"take的原碼探索"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#take的原碼探索","aria-hidden":"true"}},[this._v("#")]),this._v(" Take的原碼探索")])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",[e._v("今天要來說說"),r("code",[e._v("Take")]),e._v("的原始碼，由於"),r("code",[e._v("Take")]),e._v("跟"),r("code",[e._v("Skip")]),e._v("非常的相似，所以有些部分在"),r("code",[e._v("Skip")]),e._v("已經說過了，在這裡就只會帶過，不會再深入的說明，這裡建議可以先回去看"),r("code",[e._v("Skip")]),e._v("的部分再來看本篇文章。")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"原始碼解析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#原始碼解析","aria-hidden":"true"}},[this._v("#")]),this._v(" 原始碼解析")])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",[e._v("前面有提到"),r("code",[e._v("Take")]),e._v("有三個不同名稱的方法: "),r("code",[e._v("Take")]),e._v("、"),r("code",[e._v("TakeLast")]),e._v("、"),r("code",[e._v("TakeWhile")]),e._v("，下面我們依序來做說明。")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"take"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#take","aria-hidden":"true"}},[this._v("#")]),this._v(" Take")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-C# extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("public static IEnumerable<TSource> Take<TSource>(this IEnumerable<TSource> source, int count)\n{\n    ...\n\n    if (source is IPartition<TSource> partition)\n    {\n        return partition.Take(count);\n    }\n\n    if (source is IList<TSource> sourceList)\n    {\n        return new ListPartition<TSource>(sourceList, 0, count - 1);\n    }\n\n    return new EnumerablePartition<TSource>(source, 0, count - 1);\n}\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("前面檢查傳入參數是否合法的部分用"),t("code",[this._v("...")]),this._v("代替，剩下的是真正做事的地方，這裡會做下面幾件事:")])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",[r("li",[e._v("如果已經是"),r("code",[e._v("IPartition")]),e._v("的類別，直接叫用之前設定的"),r("code",[e._v("Take")])]),e._v(" "),r("li",[e._v("如果是"),r("code",[e._v("IList")]),e._v("，叫用"),r("code",[e._v("ListPartition")])]),e._v(" "),r("li",[e._v("上述皆不符合的話就叫用"),r("code",[e._v("EnumerablePartition")])])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",[e._v("這裡我們把焦點放到"),r("code",[e._v("Skip")]),e._v("中有出現的"),r("code",[e._v("ListPartition")]),e._v("跟"),r("code",[e._v("EnumerablePartition")]),e._v("上，它們傳入的"),r("code",[e._v("index")]),e._v("跟"),r("code",[e._v("Skip")]),e._v("剛好相反:")])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",[r("li",[r("code",[e._v("minIndexInclusive")]),e._v(": 設為"),r("code",[e._v("0")]),e._v("，代表從"),r("strong",[e._v("第一個元素")]),e._v("開始取")]),e._v(" "),r("li",[r("code",[e._v("maxIndexInclusive")]),e._v(": 設為"),r("code",[e._v("count - 1")]),e._v("，因為要從索引值"),r("code",[e._v("0")]),e._v("開始取，所以"),r("strong",[e._v("最後一個元素")]),e._v("應該要"),r("code",[e._v("count - 1")])])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",[e._v("這邊看出"),r("code",[e._v("Skip")]),e._v("跟"),r("code",[e._v("Take")]),e._v("的"),r("strong",[e._v("互補")]),e._v("關係，"),r("code",[e._v("Take")]),e._v("從"),r("code",[e._v("0")]),e._v("到"),r("code",[e._v("count - 1")]),e._v("，"),r("code",[e._v("Skip")]),e._v("從"),r("code",[e._v("count")]),e._v("到"),r("strong",[e._v("最後個")]),e._v("元素，所以兩個合併就會是原本的集合。")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"takelast"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#takelast","aria-hidden":"true"}},[this._v("#")]),this._v(" TakeLast")])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",[r("li",[e._v("檢查傳入參數合法性，如果為"),r("strong",[e._v("空")]),e._v("則拋出"),r("code",[e._v("ArgumentNull")]),e._v("例外")]),e._v(" "),r("li",[e._v("如果參數皆合法則叫用"),r("code",[e._v("TakeLastIterator")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("接下來我們來看一下"),t("code",[this._v("TakeLastIterator")]),this._v(":")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-C# extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("private static IEnumerable<TSource> TakeLastIterator<TSource>(IEnumerable<TSource> source, int count)\n{\n    ...\n    Queue<TSource> queue;\n\n    using (IEnumerator<TSource> e = source.GetEnumerator())\n    {\n        if (!e.MoveNext())\n        {\n            yield break;\n        }\n\n        queue = new Queue<TSource>();\n        queue.Enqueue(e.Current);\n\n        while (e.MoveNext())\n        {\n            if (queue.Count < count)\n            {\n                queue.Enqueue(e.Current);\n            }\n            else\n            {\n                do\n                {\n                    queue.Dequeue();\n                    queue.Enqueue(e.Current);\n                }\n                while (e.MoveNext());\n                break;\n            }\n        }\n    }\n    ...\n    do\n    {\n        yield return queue.Dequeue();\n    }\n    while (queue.Count > 0);\n}\n")])])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",[r("li",[e._v("建立一個"),r("strong",[e._v("Queue")]),e._v("存放結果集合")]),e._v(" "),r("li",[e._v("巡覽將"),r("strong",[e._v("Queue")]),e._v("給填滿至"),r("code",[e._v("count")]),e._v("的數量")]),e._v(" "),r("li",[e._v("填滿後，如果集合還沒巡覽結束，則將"),r("strong",[e._v("Queue")]),e._v("中的第一個元素丟出，再將目前的元素放入")]),e._v(" "),r("li",[e._v("重複丟出放入直到集合巡覽結束")]),e._v(" "),r("li",[e._v("將Queue中的元素回傳")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",[e._v("這裡跟"),r("code",[e._v("Skip")]),e._v("同樣都是用"),r("strong",[e._v("Queue")]),e._v("來實作，可是用法卻差很多，"),r("code",[e._v("Skip")]),r("strong",[e._v("不回傳Queue中的元素")]),e._v("，反之"),r("code",[e._v("Take")]),e._v("卻是"),r("strong",[e._v("只回傳Queue中的元素")]),e._v("。")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"takewhile"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#takewhile","aria-hidden":"true"}},[this._v("#")]),this._v(" TakeWhile")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("code",[this._v("TakeWhile")]),this._v("的公開方法做了下面的事情:")])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[this._v("判斷傳入參數是否為空，如果空的話拋出"),t("code",[this._v("ArgumentNull")]),this._v("的例外")]),this._v(" "),t("li",[this._v("傳入參數合法的話則叫用"),t("code",[this._v("TakeWhileIterator")])])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",[e._v("接下來我們來看看"),r("code",[e._v("TakeWhileIterator")]),e._v("，他有兩個方法，差別在於"),r("code",[e._v("predicate")]),e._v("有沒有傳入"),r("code",[e._v("index")]),e._v("參數，我們直接來看有"),r("code",[e._v("index")]),e._v("參數的方法:")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-C# extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("private static IEnumerable<TSource> TakeWhileIterator<TSource>(IEnumerable<TSource> source, Func<TSource, int, bool> predicate)\n{\n    int index = -1;\n    foreach (TSource element in source)\n    {\n        checked\n        {\n            index++;\n        }\n\n        if (!predicate(element, index))\n        {\n            break;\n        }\n\n        yield return element;\n    }\n}\n")])])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",[r("li",[e._v("每次跳至下一個元素，"),r("code",[e._v("index")]),e._v("就加"),r("strong",[e._v("1")])]),e._v(" "),r("li",[e._v("如果符合"),r("code",[e._v("predicate")]),e._v("的判斷，就回傳這個元素")]),e._v(" "),r("li",[e._v("如果遇到不符合"),r("code",[e._v("predicate")]),e._v("的元素，則"),r("strong",[e._v("直接結束巡覽")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"測試案例賞析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#測試案例賞析","aria-hidden":"true"}},[this._v("#")]),this._v(" 測試案例賞析")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"takewhiletests-cs"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#takewhiletests-cs","aria-hidden":"true"}},[this._v("#")]),this._v(" TakeWhileTests.cs")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h4",{attrs:{id:"sourcenonemptypredicatetruesomefalsesecond"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sourcenonemptypredicatetruesomefalsesecond","aria-hidden":"true"}},[this._v("#")]),this._v(" SourceNonEmptyPredicateTrueSomeFalseSecond")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-C# extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("[Fact]\npublic void SourceNonEmptyPredicateTrueSomeFalseSecond()\n{\n    int[] source = { 8, 3, 12, 4, 6, 10 };\n    int[] expected = { 8 };\n\n    Assert.Equal(expected, source.TakeWhile(x => x % 2 == 0));\n}\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("只要遇到不符合"),t("code",[this._v("predicate")]),this._v("的元素，之後的元素都不再做判斷直接忽略。")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"結語"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#結語","aria-hidden":"true"}},[this._v("#")]),this._v(" 結語")])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",[e._v("這次觀看的"),r("code",[e._v("Take")]),e._v("中跟"),r("code",[e._v("Skip")]),e._v("的相似之處有很多，但是也有不同且特別的部分，從"),r("code",[e._v("Skip")]),e._v("跟"),r("code",[e._v("Take")]),e._v("的原始碼中我覺得收穫最多的就是"),r("code",[e._v("Queue")]),e._v("的運用，利用"),r("code",[e._v("Queue")]),e._v("暫緩回傳時機，可以使回傳的資料有更多的彈性。")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"參考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#參考","aria-hidden":"true"}},[this._v("#")]),this._v(" 參考")])}],!1,null,null,null);t.default=s.exports}}]);