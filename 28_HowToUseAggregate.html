<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Aggregate的應用 | 深入探索 LINQ</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/DigDeeperLINQ/assets/css/0.styles.d7374936.css" as="style"><link rel="preload" href="/DigDeeperLINQ/assets/js/app.a2b9c658.js" as="script"><link rel="preload" href="/DigDeeperLINQ/assets/js/15.2bdb0b8a.js" as="script"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/10.05d50042.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/11.d5292423.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/12.efd10669.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/13.77504686.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/14.fd3e6aa6.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/16.7e9febb0.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/17.6f48564a.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/18.283b68f8.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/19.9a74edc6.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/2.cf1c94c7.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/20.26d6877e.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/21.05cf0ea3.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/22.b5e0af87.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/23.eae333c6.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/24.f0357f60.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/25.bc1e83ca.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/26.8329651e.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/27.999ff4c8.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/28.c4d765e7.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/29.19452a1e.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/3.e76eb854.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/30.160a9a4d.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/31.0056cbed.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/32.fb712cab.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/33.85d5a0b9.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/34.65a63b5d.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/4.93af7f1b.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/5.1f84db22.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/6.020a9bf3.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/7.ae02f515.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/8.8be7dbe1.js"><link rel="prefetch" href="/DigDeeperLINQ/assets/js/9.5d617883.js">
    <link rel="stylesheet" href="/DigDeeperLINQ/assets/css/0.styles.d7374936.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/DigDeeperLINQ/" class="home-link router-link-active"><!----> <span class="site-name">深入探索 LINQ</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/DigDeeperLINQ/" class="sidebar-link">目錄</a></li><li><a href="/DigDeeperLINQ/01_Preface.html" class="sidebar-link">踏上探索的旅途: 前言</a></li><li><a href="/DigDeeperLINQ/02_Prepare.html" class="sidebar-link">探索的準備: 使用工具及說明</a></li><li><a href="/DigDeeperLINQ/03_LINQPad.html" class="sidebar-link">每個.NET工程師都要有的一隻箭: LINQPad介紹</a></li><li><a href="/DigDeeperLINQ/04_foreach.html" class="sidebar-link">藏在foreach下的秘密: foreach原理說明</a></li><li><a href="/DigDeeperLINQ/05_yield.html" class="sidebar-link">仔細體會yield的甜美: yield介紹</a></li><li><a href="/DigDeeperLINQ/06_Lambda.html" class="sidebar-link">Lambda運算式介紹</a></li><li><a href="/DigDeeperLINQ/07_Generics.html" class="sidebar-link">變來變去的Generic Type: 泛型介紹</a></li><li><a href="/DigDeeperLINQ/08_WhatIsLINQ.html" class="sidebar-link">所以什麼是LINQ?</a></li><li><a href="/DigDeeperLINQ/09_HowToUseSelect.html" class="sidebar-link">Select的應用</a></li><li><a href="/DigDeeperLINQ/10_BuildCoreFX.html" class="sidebar-link">建置dotnet/corefx</a></li><li><a href="/DigDeeperLINQ/11_InsideOfSelect.html" class="sidebar-link">Select的原碼探險</a></li><li><a href="/DigDeeperLINQ/12_HowToUseSelectMany.html" class="sidebar-link">SelectMany的應用</a></li><li><a href="/DigDeeperLINQ/13_InsideOfSelectMany.html" class="sidebar-link">SelectMany的原碼探險</a></li><li><a href="/DigDeeperLINQ/14_HowToUseWhere.html" class="sidebar-link">Where的應用</a></li><li><a href="/DigDeeperLINQ/15_InsideOfWhere.html" class="sidebar-link">Where的原碼探索</a></li><li><a href="/DigDeeperLINQ/16_HowToUseOrderBy.html" class="sidebar-link">LINQ排序語法(OrderBy、OrderByDescending、ThenBy、ThenByDescending)的應用</a></li><li><a href="/DigDeeperLINQ/17_InsideOfOrderBy.html" class="sidebar-link">OrderBy的原碼探索</a></li><li><a href="/DigDeeperLINQ/18_HowToUseGroupBy.html" class="sidebar-link">GroupBy的應用</a></li><li><a href="/DigDeeperLINQ/19_InsideOfGroupBy.html" class="sidebar-link">GroupBy的原碼探索</a></li><li><a href="/DigDeeperLINQ/20_HowToUseJoin.html" class="sidebar-link">Join的應用</a></li><li><a href="/DigDeeperLINQ/21_InsideOfJoin.html" class="sidebar-link">Join的原碼探索</a></li><li><a href="/DigDeeperLINQ/22_HowToUseGroupJoin.html" class="sidebar-link">GroupJoin的應用</a></li><li><a href="/DigDeeperLINQ/23_InsideOfGroupJoin.html" class="sidebar-link">GroupJoin的原碼探索</a></li><li><a href="/DigDeeperLINQ/24_HowToUseSkip.html" class="sidebar-link">Skip的應用</a></li><li><a href="/DigDeeperLINQ/25_InsideOfSkip.html" class="sidebar-link">Skip的原碼探索</a></li><li><a href="/DigDeeperLINQ/26_HowToUseTake.html" class="sidebar-link">Take的應用</a></li><li><a href="/DigDeeperLINQ/27_InsideOfTake.html" class="sidebar-link">Take的原碼探索</a></li><li><a href="/DigDeeperLINQ/28_HowToUseAggregate.html" class="active sidebar-link">Aggregate的應用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/DigDeeperLINQ/28_HowToUseAggregate.html#功能說明" class="sidebar-link">功能說明</a></li><li class="sidebar-sub-header"><a href="/DigDeeperLINQ/28_HowToUseAggregate.html#方法定義" class="sidebar-link">方法定義</a></li><li class="sidebar-sub-header"><a href="/DigDeeperLINQ/28_HowToUseAggregate.html#方法範例" class="sidebar-link">方法範例</a></li><li class="sidebar-sub-header"><a href="/DigDeeperLINQ/28_HowToUseAggregate.html#特別之處" class="sidebar-link">特別之處</a></li><li class="sidebar-sub-header"><a href="/DigDeeperLINQ/28_HowToUseAggregate.html#結語" class="sidebar-link">結語</a></li><li class="sidebar-sub-header"><a href="/DigDeeperLINQ/28_HowToUseAggregate.html#範例程式" class="sidebar-link">範例程式</a></li><li class="sidebar-sub-header"><a href="/DigDeeperLINQ/28_HowToUseAggregate.html#參考" class="sidebar-link">參考</a></li></ul></li><li><a href="/DigDeeperLINQ/29_InsideOfAggregate.html" class="sidebar-link">Aggregate的原碼探索</a></li><li><a href="/DigDeeperLINQ/30_End.html" class="sidebar-link">旅程的結尾</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="aggregate的應用"><a href="#aggregate的應用" aria-hidden="true" class="header-anchor">#</a> Aggregate的應用</h1> <p>這次要說的<code>Aggregate</code>這個方法是在做<strong>彙整</strong>的處理，彙整資料之後可以幫我們找出很多本來看不清的數據，所以<code>Aggregate</code>這個方法的用法及實作也是很重要的，我們一起來看看吧。</p> <h2 id="功能說明"><a href="#功能說明" aria-hidden="true" class="header-anchor">#</a> 功能說明</h2> <p>以下圖為例(節錄自<a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/linq/aggregation-operations" target="_blank" rel="noopener noreferrer">Microsoft Docs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>):</p> <p><img src="data:image/png;base64,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" alt="aggregaet"></p> <p>以下說明圖片:</p> <ul><li><code>Source</code>是一個數字陣列</li> <li><code>Results</code>有兩種: <code>Sum</code>跟<code>Max</code> <ul><li><code>Sum</code>: 加總<code>Source</code>的元素數值</li> <li><code>Max</code>: <code>Source</code>元素數值的最大值</li></ul></li></ul> <p>由圖示我們可以知道<code>Aggregate</code>會對一個集合的內容整理後輸出成一個資料。</p> <h2 id="方法定義"><a href="#方法定義" aria-hidden="true" class="header-anchor">#</a> 方法定義</h2> <p><code>Aggregate</code>有<strong>三個公開方法</strong>，我們由單純到複雜來說明:</p> <h3 id="第一個方法"><a href="#第一個方法" aria-hidden="true" class="header-anchor">#</a> 第一個方法</h3> <div class="language-C# extra-class"><pre class="language-text"><code>public static TSource Aggregate&lt;TSource&gt;(
    this IEnumerable&lt;TSource&gt; source,
    Func&lt;TSource, TSource, TSource&gt; func);
</code></pre></div><ul><li><code>func</code>: 彙整資料所做的處理函式</li> <li><code>func</code>第一個傳入參數: 之前元素的彙整結果</li> <li><code>func</code>第二個傳入參數: 目前元素的資料</li> <li><code>func</code>的回傳值: 之前元素跟目前元素的彙整結果</li></ul> <p>由此可以看出來<code>Aggregate</code>這個方法其實就是把<strong>之前元素的彙整資料跟目前的元素做彙整</strong>，再將目前彙整的結果丟到下一個元素再做彙整，最後就會得到一個彙整的結果。</p> <h3 id="第二個方法"><a href="#第二個方法" aria-hidden="true" class="header-anchor">#</a> 第二個方法</h3> <div class="language-C# extra-class"><pre class="language-text"><code>public static TAccumulate Aggregate&lt;TSource, TAccumulate&gt;(
    this IEnumerable&lt;TSource&gt; source,
    TAccumulate seed,
    Func&lt;TAccumulate, TSource, TAccumulate&gt; func);
</code></pre></div><ul><li><code>seed</code>: 初始的累加值</li> <li><code>func</code>: 彙整資料所做的處理函式</li></ul> <p>這個方法多了一個<code>seed</code>參數，他是<strong>自定義的初始值</strong>，這個值會傳入<code>func</code>中，變為第一個<code>func</code>的傳入參數，以用來做彙整。</p> <h3 id="第三個方法"><a href="#第三個方法" aria-hidden="true" class="header-anchor">#</a> 第三個方法</h3> <div class="language-C# extra-class"><pre class="language-text"><code>public static TResult Aggregate&lt;TSource, TAccumulate, TResult&gt;(
    this IEnumerable&lt;TSource&gt; source,
    TAccumulate seed,
    Func&lt;TAccumulate, TSource, TAccumulate&gt; func,
    Func&lt;TAccumulate, TResult&gt; resultSelector);
</code></pre></div><p>這個方法跟上一個方法的差別只有<code>resultSelector</code>這個參數，他會在巡覽結束得到彙整資料的時候去叫用<code>resultSelector</code>去產生結果。</p> <h2 id="方法範例"><a href="#方法範例" aria-hidden="true" class="header-anchor">#</a> 方法範例</h2> <p>這次的範例我們會用<code>Aggregate</code>來實作不同的彙整處理(<code>Average</code>、<code>Count</code>、<code>Max</code>、<code>Min</code>、<code>Sum</code>)，範例中會有一行註解程式碼，它的結果跟我們輸出的結果相同。</p> <h3 id="範例資料"><a href="#範例資料" aria-hidden="true" class="header-anchor">#</a> 範例資料</h3> <div class="language-C# extra-class"><pre class="language-text"><code>int[] Source = new int[] { 2, 7, 5, 1, 6, 8, 3 };
</code></pre></div><h3 id="sum"><a href="#sum" aria-hidden="true" class="header-anchor">#</a> Sum</h3> <div class="language-C# extra-class"><pre class="language-text"><code>private static int Sum(IEnumerable&lt;int&gt; source)
{
    //return source.Sum(x =&gt; x);
    return source.Aggregate((total, next) =&gt; total + next);
}
</code></pre></div><p><code>total</code>會是之前<strong>所有元素的加總</strong>，所以每次叫用<code>func</code>時都是在加上<strong>目前的數字</strong>。</p> <h3 id="min"><a href="#min" aria-hidden="true" class="header-anchor">#</a> Min</h3> <div class="language-C# extra-class"><pre class="language-text"><code>private static int Min(IEnumerable&lt;int&gt; source)
{
    //return source.Min(x =&gt; x);
    return source.Aggregate((min, next) =&gt; min &gt; next ? next : min);
}
</code></pre></div><p>每次都去比對目前的元素是否<strong>小於</strong>目前的<strong>最小值</strong>，如果是的話就更新最小值。</p> <h3 id="max"><a href="#max" aria-hidden="true" class="header-anchor">#</a> Max</h3> <div class="language-C# extra-class"><pre class="language-text"><code>private static int Max(IEnumerable&lt;int&gt; source)
{
    //return source.Max(x =&gt; x);
    return source.Aggregate((max, next) =&gt; max &lt; next ? next : max);
}
</code></pre></div><p>每次都去比對目前的元素是否<strong>大於</strong>目前的<strong>最大值</strong>，如果是的話就更新最大值。</p> <h3 id="count"><a href="#count" aria-hidden="true" class="header-anchor">#</a> Count</h3> <div class="language-C# extra-class"><pre class="language-text"><code>private static int Count(IEnumerable&lt;int&gt; source)
{
    //return source.Count();
    return source.Aggregate(0, (count, next) =&gt; ++count);
}
</code></pre></div><p>以<strong>0</strong>為起始彙整資料，每個元素都累加<strong>1</strong>。</p> <h3 id="average"><a href="#average" aria-hidden="true" class="header-anchor">#</a> Average</h3> <div class="language-C# extra-class"><pre class="language-text"><code>private static double Average(IEnumerable&lt;int&gt; source)
{
    int count = 0;

    //return source.Average(x =&gt; x);
    return source.Aggregate(
        0,
        (total, next) =&gt;
        {
            total = total + next;
            count++;
            return total;
        },
        total =&gt; (double)total / count
    );
}
</code></pre></div><p>累加元素並對外部變數<code>count</code>加<strong>1</strong>，最後用<code>resultSelector</code>取得<strong>平均</strong>資料。</p> <p>範例的結果如下:</p> <div class="language-C# extra-class"><pre class="language-text"><code>/*
 * Source: 2,7,5,1,6,8,3
 *  Average: 4.57142857142857
 *  Count: 7
 *  Max: 8
 *  Min: 1
 *  Sum: 32
 */
</code></pre></div><h2 id="特別之處"><a href="#特別之處" aria-hidden="true" class="header-anchor">#</a> 特別之處</h2> <ul><li><strong>沒有延遲執行</strong>的特性，一旦叫用會馬上觸發</li></ul> <h2 id="結語"><a href="#結語" aria-hidden="true" class="header-anchor">#</a> 結語</h2> <p>這次的<code>Aggregate</code>只要了解<code>func</code>中兩個傳入參數: <strong>累加值</strong>跟<strong>目前元素值</strong>就可以理解他的運用方法了，搭配不同的彙整處理的例子又更加的明確，下一章我們來看看<code>Aggregate</code>的原理。</p> <h2 id="範例程式"><a href="#範例程式" aria-hidden="true" class="header-anchor">#</a> 範例程式</h2> <ul><li><a href="https://github.com/peterhpchen/DigDeeperLINQ/tree/28_HowToUseAggregate/demo/28_HowToUseAggregate" target="_blank" rel="noopener noreferrer">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="參考"><a href="#參考" aria-hidden="true" class="header-anchor">#</a> 參考</h2> <ul><li><a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/linq/aggregation-operations" target="_blank" rel="noopener noreferrer">Microsoft Docs-aggregation-operations<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.aggregate?view=netframework-4.7.1" target="_blank" rel="noopener noreferrer">Microsoft Docs-system.linq.enumerable.aggregate<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/DigDeeperLINQ/27_InsideOfTake.html" class="prev">
          Take的原碼探索
        </a></span> <span class="next"><a href="/DigDeeperLINQ/29_InsideOfAggregate.html">
          Aggregate的原碼探索
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/DigDeeperLINQ/assets/js/app.a2b9c658.js" defer></script><script src="/DigDeeperLINQ/assets/js/15.2bdb0b8a.js" defer></script>
  </body>
</html>
